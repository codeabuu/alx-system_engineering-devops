#!/usr/bin/env bash
# Installs nginx server
apt-get update
apt-get -y install nginx
ufw allow 'Nginx HTTP'
echo "Hello World!" > /var/www/html/index.html

# Create a new Nginx configuration for the redirection
echo "server {
    listen 80 default_server;
    listen [::]:80 default_server;

    location /redirect_me {
        return 301 http://example.com; # Replace with the actual URL
    }

    # Additional server configuration can be added here if needed
}" > /etc/nginx/sites-available/redirect

# Create a symbolic link to enable the configuration
ln -s /etc/nginx/sites-available/redirect /etc/nginx/sites-enabled/

# Test the Nginx configuration for syntax errors
if nginx -t; then
    # Reload Nginx to apply the new configuration
    service nginx reload
    echo "Nginx configuration reloaded successfully."
else
    echo "Nginx configuration test failed. Check your configuration."
fi
